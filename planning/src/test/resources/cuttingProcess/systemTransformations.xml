<?xml version="1.0" encoding="UTF-8"?>
<systemTransformations xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../systemTransformations.xsd">
	<systemTransformation name="ELEMENT-CUT-CYLINDER-SURFACE">
		<systemTemplate>
			<objectTemplates>
				<objectTemplate id="ID-WORKPIECE">
					<attributeTemplates>
						<attributeTemplate name="ATTRIBUTE-WORKPIECE" value="true" />
					</attributeTemplates>
					<linkTemplates>
						<linkTemplate name="LINK-IS-PART-OF" value="ID-CYLINDER-SURFACE" />
						<linkTemplate name="LINK-IS-REQUIREMENT-OF" value="ID-REQUIREMENT" />
					</linkTemplates>
				</objectTemplate>
				<objectTemplate id="ID-CYLINDER-SURFACE">
					<attributeTemplates>
						<attributeTemplate name="ATTRIBUTE-CYLINDER-SURFACE" value="true" />
						<attributeTemplate name="ATTRIBUTE-DIAMETER" />
						<attributeTemplate name="ATTRIBUTE-HAS-DIAMETER-REQUIREMENT" value="false" />
					</attributeTemplates>
					<linkTemplates>
						<linkTemplate name="LINK-IS-PART-OF" value="ID-WORKPIECE" />
						<linkTemplate name="LINK-IS-DIAMETER-REQUIREMENT" value="null" />
					</linkTemplates>
				</objectTemplate>
				<objectTemplate id="ID-REQUIREMENT">
					<attributeTemplates>
						<attributeTemplate name="ATTRIBUTE-REQUIREMENT" value="true"/>
						<attributeTemplate name="ATTRIBUTE-REQUIREMENT" />
						<attributeTemplate name="ATTRIBUTE-DIAMETER-REQUIREMENT-STATUS" value="false" />
					</attributeTemplates>
					<linkTemplates>
						<linkTemplate name="LINK-IS-REQUIREMENT-OF" value="ID-WORKPIECE" />
						<linkTemplate name="LINK-IS-DIAMETER-REQUIREMENT" value="null" />
					</linkTemplates>
				</objectTemplate>
			</objectTemplates>
		</systemTemplate>
		<transformations>
			<transformation type="attribute" objectId="ID-ROBOT" attributeName="ATTRIBUTE-DIAMETER-REQUIREMENT-STATUS" attributeValue="true" />
			<transformation type="link" objectId="ID-REQUIREMENT" linkName="LINK-IS-DIAMETER-REQUIREMENT" linkOldValue="null" linkNewValue="ID-CYLINDER-SURFACE" />
			<transformation type="link" objectId="ID-CYLINDER-SURFACE" linkName="LINK-IS-DIAMETER-REQUIREMENT" linkOldValue="null" linkNewValue="ID-REQUIREMENT" />
			<transformation type="attribute" objectId="ID-CYLINDER-SURFACE" attributeName="ATTRIBUTE-HAS-DIAMETER-REQUIREMENT" attributeValue="true" />
		</transformations>
			<action name="OPERATION_CUT_CYLINDER_SURFACE">
				<preConditionCheckers>
					<preConditionChecker>
						<script type="lua">
							<line n="1">local systemVariant = ...</line>
							<line n="2">local cylinderSurface_actual = systemVariant:getObjectByIdMatch('ID-CYLINDER-SURFACE')</line>
							<line n="3">local diameter = cylinderSurface_actual:getAttribute('ATTRIBUTE-DIAMETER'):getValueAsInteger()</line>
							<line n="4">local requirement_actual = systemVariant:getObjectByIdMatch('ID-REQUIREMENT')</line>
							<line n="5">local diameterRequired = requirement_actual:getAttribute('ATTRIBUTE-DIAMETER-REQUIREMENT'):getValueAsInteger()</line>
							<line n="6">return diameter > diameterRequired</line>
						</script>
					</preConditionChecker>
				</preConditionCheckers>
				<parameterUpdaters>
					<parameterUpdater>
						<script type="lua">
							<line n="1">local systemVariant = ...</line>
							<line n="2">local cylinderSurface_actual = systemVariant:getObjectByIdMatch('ID-CYLINDER-SURFACE')</line>
							<line n="3">local diameter = cylinderSurface_actual:getAttribute('ATTRIBUTE-DIAMETER'):getValueAsInteger()</line>
							<line n="4">local requirement_actual = systemVariant:getObjectByIdMatch('ID-REQUIREMENT')</line>
							<line n="5">local diameterRequired = requirement_actual:getAttribute('ATTRIBUTE-DIAMETER-REQUIREMENT'):getValueAsInteger()</line>
							<line n="6">local diameterDelta = diameter - diameterRequired</line>
							<line n="7">systemVariant:setActionParameter('PARAMETER-DIAMETER-DELTA', diameterDelta)</line>
							<line n="8">cylinderSurface_actual:getAttribute('ATTRIBUTE-DIAMETER'):setValue(diameterRequired)</line>
						</script>
					</parameterUpdater>
				</parameterUpdaters>
			</action>
	</systemTransformation>
</systemTransformations>
